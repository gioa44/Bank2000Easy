SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
CREATE FUNCTION [dbo].[itrs_show_accounts_nonres] ()
RETURNS @tbl TABLE (ACC_ID int NOT NULL PRIMARY KEY, ACCOUNT TACCOUNT NOT NULL, ISO TISO NOT NULL, IS_JURIDICAL bit NOT NULL)
AS
BEGIN
	INSERT INTO @tbl 
	SELECT A.ACC_ID, A.ACCOUNT, A.ISO, C.IS_JURIDICAL
	FROM dbo.ACCOUNTS A (NOLOCK) 
		INNER JOIN dbo.CLIENTS C ON C.CLIENT_NO = A.CLIENT_NO
	WHERE C.IS_RESIDENT = 0 AND A.BAL_ACC_ALT IN 
		(
			3601, 
			3611,
			3402,
			3403,
			3404,
			3405,
			3406,
			3407,
			3408,
			3412,
			3413,
			3414,
			3415,
			3416,
			3417,
			3418,
			3602,
			3603,
			3604,
			3605,
			3606,
			3607,
			3608,
			3612,
			3613,
			3614,
			3615,
			3616,
			3617,
			3618
		)
	RETURN
END
GO
